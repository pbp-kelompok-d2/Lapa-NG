{% extends 'base.html' %}
{% load static %}

{% block meta %}
<title>Lapa-NG</title>
{% endblock meta %}

{% block styles %}
<style>
    #filter-container {
    /* Use the Django static tag HERE where it works */
    background-image: url("{% static 'images/search-bg-geometric-Pngtree-.jpg' %}");
    background-size: cover;
    background-position: center center;
    background-repeat: no-repeat;
  }

  /* Optional text shadow for readability */
  #filter-container label,
  #filter-container #clear-filter-btn {
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
  }

 .venue-card {
    position: relative; /* Base for pseudo-element */
    /* Transitions for transform/shadow are handled by Tailwind classes */
  }

  /* Hover effect: Lift and shadow (Tailwind classes handle this visually) */
  .venue-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1); /* shadow-lg */
  }

  /* Pseudo-element for the gradient border */
  .venue-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0; /* Cover entire card */
    z-index: 0; /* Base layer for the border */
    border-radius: inherit; /* Match card's rounding (rounded-lg) */
    padding: 2px; /* Border thickness */
    background: linear-gradient(to top right, #4b8fff, #a1e4c2, #10b810);  /* Gradient */
    /* Masking */
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: destination-out;
            mask-composite: exclude;
    opacity: 0; /* Hidden by default */
    transition: opacity 0.3s ease-in-out;
    pointer-events: none; /* Ensure it doesn't block interactions */
  }

  /* Show the gradient border on hover */
  .venue-card:hover::before {
    opacity: 1;
  }

  /* --- MODIFIED --- */
  /* Explicitly position direct children above the pseudo-element */
  /* Target BOTH the image container and the content container */
  .venue-card > div { /* Selects direct div children */
      position: relative; /* Create stacking context */
      z-index: 1; /* Place above ::before (z-index: 0) */
      /* Ensure background of content area is opaque if needed */
      /* background-color: white; /* Add if card bg is transparent */ 
  }

  /* Ensure absolute positioned elements like 'Featured' are also above */
   .venue-card > span { /* Selects direct span children (like the Featured badge) */
       position: relative; /* Ensure it participates in stacking relative to its parent */
       z-index: 2; /* Make sure it's even above the other content if overlapping */
   }
   /* --- END MODIFIED --- */
</style>
{% endblock styles %}

{% block content %}
{% include 'navbar.html' %}

<div id="hero-section" class="fixed inset-0 z-40 h-screen w-full overflow-hidden transition-all duration-[1200ms] ease-in-out bg-gray-800">

    <div id="hero-slider-track" class="h-full w-full flex transition-transform duration-700 ease-in-out">
        <div class="hero-slide h-full w-full flex-shrink-0 bg-cover bg-center relative">
             <div class="absolute inset-0 bg-black bg-opacity-40"></div> </div>
        <div class="hero-slide h-full w-full flex-shrink-0 bg-cover bg-center relative">
             <div class="absolute inset-0 bg-black bg-opacity-40"></div>
        </div>
        <div class="hero-slide h-full w-full flex-shrink-0 bg-cover bg-center relative">
             <div class="absolute inset-0 bg-black bg-opacity-40"></div>
        </div>
        <div class="hero-slide h-full w-full flex-shrink-0 bg-cover bg-center relative">
             <div class="absolute inset-0 bg-black bg-opacity-40"></div>
        </div>
        <div class="hero-slide h-full w-full flex-shrink-0 bg-cover bg-center relative">
             <div class="absolute inset-0 bg-black bg-opacity-40"></div>
        </div>
        </div>

    <div class="absolute inset-0 z-10 flex flex-col items-center justify-center text-center text-white px-4 pointer-events-none">
        <h1 id="hero-welcome" class="text-4xl md:text-6xl font-bold font-heading mb-4 opacity-0 transition-opacity duration-1000 ease-in-out delay-500 bg-gradient-to-tr from-[#4b8fff] via-[#a1e4c2] to-[#10b981] bg-clip-text text-transparent">
        Welcome{% if user.is_authenticated %}, {{ user.customuser.name }}{% endif %}!
        </h1>
        <p id="hero-slogan" class="text-lg md:text-2xl mb-8 opacity-0 transition-opacity duration-1000 ease-in-out delay-1000">
            Find and Book Your Favorite Sports Venues Easily
        </p>
        <button id="hero-reveal-btn" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg text-lg opacity-0 transition-all duration-1000 ease-in-out delay-1500 pointer-events-auto">
            Explore Venues
        </button>
    </div>

    <div id="hero-dots" class="absolute bottom-6 left-1/2 -translate-x-1/2 z-20 flex space-x-2">
        </div>
</div>
<!-- search bar container -->
<div id="content-wrapper" class="relative z-30 mt-[100vh] transition-all duration-[1200ms] ease-in-out">
    <main id="main-content" class="max-w-7xl mx-auto px-6 lg:px-8 py-12 md:py-16 bg-gray-50">

        <div id="filter-container" class="mb-8 p-6 rounded-xl shadow-lg">
            <form id="filter-form" method="GET" action="{% url 'main:show_main' %}" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                {% csrf_token %}

                {# Location Input #}
                <div>
                    {# Changed text-white to text-teal-900 (or another dark theme color) #}
                    <label for="q" class="block text-sm font-medium text-teal-900 mb-1">Location</label>
                    <input type="text" name="q" id="q" value="{{ current_filters.q }}" placeholder="Enter city or area"
                           class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:border-transparent transition duration-150 ease-in-out bg-white/90 text-gray-800 placeholder-gray-500">
                </div>
                 {# Sport Type Select #}
                <div>
                     {# Changed text-white to text-teal-900 #}
                    <label for="category" class="block text-sm font-medium text-teal-900 mb-1">Sport Type</label>
                    <select name="category" id="category"
                           class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:border-transparent transition duration-150 ease-in-out bg-white/90 text-gray-800 appearance-none">
                         <option value="">All Types</option>
                        {% for category in categories %}<option value="{{ category }}" {% if current_filters.category == category %}selected{% endif %}>{{ category|capfirst }}</option>{% endfor %}
                    </select>
                </div>
                {# Price Range Select #}
                <div>
                     {# Changed text-white to text-teal-900 #}
                    <label for="price_range" class="block text-sm font-medium text-teal-900 mb-1">Price Range</label>
                    <select name="price_range" id="price_range"
                           class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:border-transparent transition duration-150 ease-in-out bg-white/90 text-gray-800 appearance-none">
                        <option value="">Any Price</option>
                        {% for key, display_text in price_ranges.items %}<option value="{{ key }}" {% if current_filters.price_range == key %}selected{% endif %}>{{ display_text }}</option>{% endfor %}
                    </select>
                </div>
                 {# Search Button #}
                 <div>
                    <button type="submit"
                      class="w-full bg-emerald-600 text-white font-medium py-2.5 px-6 rounded-lg hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:ring-offset-2 focus:ring-offset-emerald-500 transition duration-150 ease-in-out flex items-center justify-center gap-2">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                      <span>Search Venues</span>
                    </button>
                </div>
                {# Clear Filters Link #}
                <div class="md:col-span-4 mt-2">
                    <a id="clear-filter-btn" href="{% url 'main:show_main' %}"
                       class="inline-flex items-center gap-1.5 px-3 py-1 bg-gray-100 hover:bg-orange-500 text-gray-400 hover:text-white text-xs font-medium rounded-md shadow-sm transition-colors border border-gray-300 hover:border-orange-500"> 
                        <img src="{% static 'images/filter-reset.svg' %}" alt="Reset" class="w-3 h-3 opacity-70 group-hover:opacity-100 transition-opacity"> 
                        <span>Clear all filters</span>
                    </a>
                </div>
            </form>
        </div>
        {# --- END SEARCH BAR CONTAINER --- #}

        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold font-heading">Daftar Venue</h1>
           {% if user.is_authenticated and user.customuser.role == 'owner' %}
                <button id="add-venue-btn" class="bg-teal-500 hover:bg-teal-600 text-white px-5 py-2 rounded-md font-medium transition">
                    + Add Venue
                </button>
            {% endif %}
        </div>

        <div id="venue-list-container">
            {% include '_venue_list.html' with venues=venues %}
        </div>

        <div id="pagination-container" class="mt-8">
            {% include '_pagination.html' %}
        </div>
    </main> 
</div>
 <script id="main-script-data"
    type="application/json"
    data-filter-url="{% url 'main:filter_venues' %}"
    data-show-main-url="{% url 'main:show_main' %}"
    data-venue-detail-url-template="{% url 'main:get_venue_details' slug='SLUG_PLACEHOLDER' %}"
    data-booking-add-url-template="{% url 'booking:add_to_cart' venue_id=0 %}"
    data-booking-redirect-url="/booking/"
    data-get-create-form-url="{% url 'main:get_create_form' %}"
    data-get-edit-form-url-template="{% url 'main:get_edit_form' slug='SLUG_PLACEHOLDER' %}"
    data-get-delete-form-url-template="{% url 'main:get_delete_form' slug='SLUG_PLACEHOLDER' %}" ></script>

{% endblock content %}

{% block scripts %}
<script src="{% static 'js/main.js' %}"></script>
{% endblock scripts %}
